<%= render 'sidebar' %>
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
  <%= bootstrap_flash %>
  <h1 class="page-header">Compras</h1>
  <div class="row">
    <%= form_tag(purchases_path, :method => "get", id: "purchases-search-form", role: "search") do %>
      <div class="col-lg-8">
        <div class="input-group">
          <span class="input-group-btn">
            <%= button_tag(type: 'submit', class: "btn btn-default") do %>
              Buscar
            <% end %>
          </span>
          <%= text_field_tag :search, params[:search], class: "form-control", value: params[:search], placeholder: 'Ingrese el numero de compra o factura...' %>
        </div><!-- /input-group -->
      </div><!-- /.col-lg-8 -->
      <div class="col-lg-4">
        <%= select_tag(:ordering, options_for_select([ ['Mas reciente', "0"], ['Mas antiguo', "1"], ['Mayor monto', "2"], ['Menor monto', "3"] ], :selected => params[:ordering] ), {:class => 'form-control'})  %> 
      </div><!-- /.col-lg-4 -->
    <% end %>
  </div> 
  <br>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>#</th>
        <th>Proveedor</th>
        <th>Subtotal</th>
        <th>IVA</th>
        <th>Total</th>
        <th class="text-center">Factura</th>
        <th class="text-center">Comentario</th>
      </tr>
    </thead>
    <tbody>
      <% @purchases.each do |purchase| %>
        <tr>
          <td><%= link_to purchase.id, purchase %></td>
          <td><%= link_to purchase.provider.name, purchase.provider %></td>
          <td><%= number_to_currency(purchase.subtotal, unit: "Bs. ", separator: ",", delimiter: ".") %></td>
          <td><%= number_to_currency(purchase.tax, unit: "Bs. ", separator: ",", delimiter: ".") %></td>
          <td><%= number_to_currency(purchase.total, unit: "Bs. ", separator: ",", delimiter: ".") %></td>
          <td class="text-center"><%= purchase.invoice %></td>
          <td class="text-center"><%= purchase.comment.present? ? purchase.comment : "-" %></td>
          <td class="text-center">
            <div class="btn-group">
              <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-gear"></i> <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><%= link_to 'Ver detalle', purchase %></li>
                <li><%= link_to 'Editar', edit_purchase_path(purchase) %></li>
                <li><%= link_to 'Eliminar', purchase, method: :delete, data: { confirm: 'Â¿Seguro que deseas eliminar la compra #' + purchase.id.to_s + '?' } %></li>
              </ul>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>